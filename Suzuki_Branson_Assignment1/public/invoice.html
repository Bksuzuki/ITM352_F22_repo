<!-- Source product information -->

<script src="./products.js" type="text/javascript"></script>

<script>
 
    // turning query string into array
        let params = (new URL(document.location)).searchParams;
       
</script>

<!DOCTYPE html>
<html lang="en">
<head>
</head>
<body>
<div class="page-content container">
                <div class="table-responsive">
                    <table border="2">
                        <th>Items</th>
                        <th>Quantity</th>
                        <th>Price</th>
                        <th>Total For Watch Type</th>
                    <script> 
                        var subtotal = 0;
                        //lopp in order to recieve quantity information from server
                        for (i = 0; i < products.length; i++) {
                            if (params.has("quantity"+i))
                            {
                                var q=params.get("quantity"+i);
                            }
                        else {
                            continue;
                        }
                        //computing total prices
                            var extended_price = (products[i].price * q)
                            subtotal = subtotal + extended_price;
                            if (q != 0) {
                                document.write(`
                            <tr>
                                <td>${products[i]['name']}</td>
                                <td>${q}</td>
                                <td>$${products[i]['price'].toFixed(2)}</td>
                                <td>$${(products[i]['price'] * q).toFixed(2)}</td>
                            </tr> 
                            </tbody>
                           `);
                            }
                        }
                        </script>
                    </table>
                    </div>

                   <script>
                    //taken and modified from Blake Saari's ITM Repo from Spring 2022. But also knew concept from Making Change WOD
                        var tax = (subtotal * 0.045)
                        var shipping = 0;
                        // Subtotal if less than $20
                            if (subtotal < 20){
                                shipping = 3;
                            // Subtotal if less than $50 and over $20
                            } else if (subtotal >= 20 && subtotal < 50){ 
                                shipping = 5;
                            // Subtotal if more than $50
                            } else if (subtotal >= 50) {
                                shipping = subtotal * 0.05;
                            }
                        // Total Calculations
                            var total = (subtotal + shipping + tax)
                            
                        document.write(`    
                        <div class="col-12 col-sm-10 text-grey text-90 order-first order-sm-last">
                            <div class="row my-2">
                                <div class="col-7 text-right">
                                    Subtotal
                                </div>
                                <div class="col-5">
                                    <span class="text-120 text-secondary-d1">$${subtotal.toFixed(2)}</span>
                                </div>
                            </div>
                            <div class="row my-2">
                                <div class="col-7 text-right">
                                    Tax (4.5%)
                                </div>
                                <div class="col-5">
                                    <span class="text-110 text-secondary-d1">$${tax.toFixed(2)}</span>
                                </div>
                            </div>
                            <div class="row my-2">
                                <div class="col-7 text-right">
                                   Shipping
                                </div>
                                <div class="col-5">
                                    <span class="text-110 text-secondary-d1">$${shipping.toFixed(2)}</span>
                                </div>
                            </div>
                            <div class="row my-2 align-items-center bgc-primary-l3 p-2">
                                <div class="col-7 text-right">
                                    Total Amount
                                </div>
                                <div class="col-5">
                                    <span class="text-150 text-success-d3 opacity-2">$${total.toFixed(2)}</span>
                                </div>
                            </div>
                        </div>
                    `)
                    </script>
                </div>
            </div>
        </div>
</div>

    <table class = "Shipping Policy">               
        <tr>
            <td colspan="6">
                <br>Shipping Policy:</br>
                <br>A subtotal $0 - $250 will be charged $15 for shipping.</br>
                <br>A subtotal $250 - $500 will be charged $25 for shipping.</br>
                <br>A subtotal over $500 will be charged 15% of the subtotal.</br>
        </tr>
    </table> 
</style>
</body>
</html>