<!DOCTYPE html>
<html lang="en">
<head>
    <script>
        // Load functions from example assignment 3
        src="./functions.js";
        var products;
        loadJSON('get_products', function (response) {
            // Parsing JSON string into object
            products_data = JSON.parse(response);
        });
        loadJSON('get_cart', function (response) {
            // Parsing JSON string into object
            cart = JSON.parse(response);
        });
    </script>
    <script src="./products.js" type="text/javascript"></script>
    <script src="./functions.js"></script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--Template taken from w3 Schools-->
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karma">
  <link rel="stylesheet" href="./css/products_home_style.css">
    <title>Cart</title>
</head>
<body>
    
    <script> 
       
       var subtotal = 0;

for(let products_key in cart) {
    let products = products_data[products_key];
    for(let i in cart[products_key]) {
        qty = cart[products_key][i];
        var extended_price = qty * products[i].price;
        var subtotal = subtotal + extended_price;
        console.log(extended_price);
        console.log(subtotal);
        if  (qty > 0) {
            
        document.write(`
        
        
        <div class = "Cart-Items pad">
            <div class = "image-box">
                <img src = "${products[i].image}" style={{ height=120px}}/>
            </div>
        <div class = "about">
                <h1 class="title">${products_key}: ${products[i].name}</h1>
        </div>
        <div class="counter">
            <div class="count">Quantity: ${qty}</div>
        </div>
        <div class = "prices">
            <div class="amount">$${extended_price}</div>
            <div class = "remove">
                <u>
                    <form name = "remove" action = "/delete_in_cart" method = "POST">
                        <button class="removecart" type="submit">Remove</button>
                        <input type = "hidden" name="pkey" value="${products_key}">
                        <input type = "hidden" name="pindex" value="${i}">
                    </form>
                </u>
            </div>
        </div>
        </div>
          `);
        }}
}
        </script>
</body>
</html>